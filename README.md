# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ø–æ –ë–∞–∑–∞–º –î–∞–Ω–Ω—ã—Ö 
–í–∞—Ä–∏–∞–Ω—Ç 39. ‚ôªÔ∏è –°–∏—Å—Ç–µ–º–∞ —É—á–µ—Ç–∞ –æ—Ç—Ö–æ–¥–æ–≤ –∏ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∏ –≤ –≥–æ—Ä–æ–¥–µ  
Telegram: @PremiumVSTR

### –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

**–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:**

–ò–º–µ—é—Ç—Å—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏ (–∞–¥—Ä–µ—Å, —Ç–∏–ø –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ - —Å—Ç–µ–∫–ª–æ, –ø–ª–∞—Å—Ç–∏–∫, –±—É–º–∞–≥–∞), –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤—ã–≤–æ–∑–∞ (–Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, —Ç–µ–ª–µ—Ñ–æ–Ω) –∏ –∞–∫—Ç—ã –≤—ã–≤–æ–∑–∞ (–¥–∞—Ç–∞, –≤–µ—Å –æ—Ç—Ö–æ–¥–æ–≤). –ù–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è —Å–≤–µ–¥–µ–Ω–∏—è –æ –≤—ã–≤–µ–∑–µ–Ω–Ω—ã—Ö –æ—Ç—Ö–æ–¥–∞—Ö —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤, –¥–∞—Ç—ã –≤—ã–≤–æ–∑–∞ –∏ –≤–µ—Å–∞.

**üè∑Ô∏è –°—É—â–Ω–æ—Å—Ç–∏:**

1. **–†–∞–π–æ–Ω** (id_—Ä–∞–π–æ–Ω–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ_—Ä–∞–π–æ–Ω–∞)
2. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è –ø–ª–æ—â–∞–¥–∫–∞** (id_–ø–ª–æ—â–∞–¥–∫–∏, –∞–¥—Ä–µ—Å, id_—Ä–∞–π–æ–Ω–∞)
3. **–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤** (id_—Ç–∏–ø–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ_—Ç–∏–ø–∞)
4. **–û–ø–µ—Ä–∞—Ç–æ—Ä** (id_–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ_–∫–æ–º–ø–∞–Ω–∏–∏, —Ç–µ–ª–µ—Ñ–æ–Ω)
5. **–ê–∫—Ç –≤—ã–≤–æ–∑–∞** (id_–∞–∫—Ç–∞, id_–ø–ª–æ—â–∞–¥–∫–∏, id_–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, id_—Ç–∏–ø–∞, –¥–∞—Ç–∞_–≤—ã–≤–æ–∑–∞, –≤–µ—Å_–∫–≥)

**üîÑ –ü—Ä–æ—Ü–µ—Å—Å—ã:**

–û–ø–µ—Ä–∞—Ç–æ—Ä—ã —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –∞–∫—Ç—ã –≤—ã–≤–æ–∑–∞ –æ—Ç—Ö–æ–¥–æ–≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö –ø–ª–æ—â–∞–¥–æ–∫. –ö–∞–∂–¥–∞—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–∞—è –ø–ª–æ—â–∞–¥–∫–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ —Ä–∞–π–æ–Ω—É –≥–æ—Ä–æ–¥–∞ –∏ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ—Ç—Ö–æ–¥–æ–≤.

**üìÑ –í—ã—Ö–æ–¥–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**

1. üìä –û—Ç—á–µ—Ç –ø–æ –æ–±—â–µ–º—É –≤–µ—Å—É –≤—ã–≤–µ–∑–µ–Ω–Ω—ã—Ö –æ—Ç—Ö–æ–¥–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∑–∞ –º–µ—Å—è—Ü –ø–æ —Ä–∞–π–æ–Ω–∞–º –≥–æ—Ä–æ–¥–∞, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ —É–±—ã–≤–∞–Ω–∏—é –≤–µ—Å–∞
2. üìÖ –î–ª—è –∑–∞–¥–∞–Ω–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤—ã–¥–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –∏ —á–∞—Å—Ç–æ—Ç—É –≤—ã–≤–æ–∑–∞ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ –¥–∞—Ç–µ

---

## –ú–æ–¥–µ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (3 —Ç–∞–±–ª–∏—Ü—ã)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

#### –¢–∞–±–ª–∏—Ü–∞: collection_point (–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–µ –ø–ª–æ—â–∞–¥–∫–∏)  
–°–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–ª–æ—â–∞–¥–∫–∞—Ö –∏ —Ä–∞–π–æ–Ω–∞—Ö.

| –ü–æ–ª–µ       | –¢–∏–ø          | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è           | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|------------|--------------|----------------------|---------------------------|
| point_id   | SERIAL       | PRIMARY KEY          | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–ª–æ—â–∞–¥–∫–∏ |
| address    | VARCHAR(500) | UNIQUE, NOT NULL     | –ê–¥—Ä–µ—Å –ø–ª–æ—â–∞–¥–∫–∏            |
| district   | VARCHAR(100) | NOT NULL             | –ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–π–æ–Ω–∞           |

#### –¢–∞–±–ª–∏—Ü–∞: waste_operator (–û–ø–µ—Ä–∞—Ç–æ—Ä—ã –≤—ã–≤–æ–∑–∞)  
–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–æ–º–ø–∞–Ω–∏—è—Ö-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞—Ö.

| –ü–æ–ª–µ         | –¢–∏–ø          | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è           | –û–ø–∏—Å–∞–Ω–∏–µ                  |
|--------------|--------------|-----------------------|---------------------------|
| operator_id  | SERIAL       | PRIMARY KEY           | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ |
| company_name | VARCHAR(200) | UNIQUE, NOT NULL      | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏      |
| phone        | VARCHAR(20)  | NOT NULL              | –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω        |

#### –¢–∞–±–ª–∏—Ü–∞: waste_removal_act (–ê–∫—Ç—ã –≤—ã–≤–æ–∑–∞)  
–û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Å–æ –≤—Å–µ–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –æ –≤—ã–≤–æ–∑–µ.

| –ü–æ–ª–µ         | –¢–∏–ø            | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                                | –û–ø–∏—Å–∞–Ω–∏–µ                       |
|--------------|----------------|-------------------------------------------|--------------------------------|
| act_id       | SERIAL         | PRIMARY KEY                              | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞–∫—Ç–∞  |
| point_id     | INTEGER        | FOREIGN KEY REFERENCES collection_point(point_id) | –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–ª–æ—â–∞–¥–∫—É             |
| operator_id  | INTEGER        | FOREIGN KEY REFERENCES waste_operator(operator_id) | –°—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞            |
| removal_date | DATE           | NOT NULL                                 | –î–∞—Ç–∞ –≤—ã–≤–æ–∑–∞                   |
| waste_type   | VARCHAR(50)    | NOT NULL                                 | –¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤ (—Å—Ç–µ–∫–ª–æ/–ø–ª–∞—Å—Ç–∏–∫/–±—É–º–∞–≥–∞) |
| weight_kg   | DECIMAL(10,2)  | NOT NULL CHECK (weight_kg > 0)           | –í–µ—Å –æ—Ç—Ö–æ–¥–æ–≤ –≤ –∫–≥              |

### –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
- `collection_point` ‚Üí `waste_removal_act`: –û–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º (–æ–¥–Ω–∞ –ø–ª–æ—â–∞–¥–∫–∞ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –º–Ω–æ–≥–æ –∞–∫—Ç–æ–≤ –≤—ã–≤–æ–∑–∞)  
- `waste_operator` ‚Üí `waste_removal_act`: –û–¥–∏–Ω –∫–æ –º–Ω–æ–≥–∏–º (–æ–¥–∏–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–Ω–æ–≥–æ –≤—ã–≤–æ–∑–æ–≤)  

### –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞
- –ê–¥—Ä–µ—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º  
- –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏-–æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º  
- –í–µ—Å –æ—Ç—Ö–æ–¥–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ 0  
- –ù–µ–ª—å–∑—è —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–≤–∞ –≤—ã–≤–æ–∑–∞ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ —Å –æ–¥–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤ –æ–¥–∏–Ω –¥–µ–Ω—å  
- –î–∞—Ç–∞ –≤—ã–≤–æ–∑–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è  

## –§–∏–∑–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å (DDL)
```sql
-- 1. –¢–∞–±–ª–∏—Ü–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã—Ö –ø–ª–æ—â–∞–¥–æ–∫
CREATE TABLE collection_point (
    point_id SERIAL PRIMARY KEY,
    address VARCHAR(500) UNIQUE NOT NULL,
    district VARCHAR(100) NOT NULL,
    is_active BOOLEAN DEFAULT TRUE
);

-- 2. –¢–∞–±–ª–∏—Ü–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –≤—ã–≤–æ–∑–∞
CREATE TABLE waste_operator (
    operator_id SERIAL PRIMARY KEY,
    company_name VARCHAR(200) UNIQUE NOT NULL,
    phone VARCHAR(20) NOT NULL
);

-- 3. –¢–∞–±–ª–∏—Ü–∞ –∞–∫—Ç–æ–≤ –≤—ã–≤–æ–∑–∞
CREATE TABLE waste_removal_act (
    act_id SERIAL PRIMARY KEY,
    point_id INTEGER NOT NULL,
    operator_id INTEGER NOT NULL,
    removal_date DATE NOT NULL,
    waste_type VARCHAR(50) NOT NULL,
    weight_kg DECIMAL(10,2) NOT NULL CHECK (weight_kg > 0),
    
    FOREIGN KEY (point_id) REFERENCES collection_point(point_id) ON DELETE CASCADE,
    FOREIGN KEY (operator_id) REFERENCES waste_operator(operator_id) ON DELETE RESTRICT,
    
    -- –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –Ω–µ–ª—å–∑—è –¥–≤–∞–∂–¥—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–æ–∑ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ —Å –æ–¥–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏ –≤ –æ–¥–∏–Ω –¥–µ–Ω—å
    UNIQUE (point_id, waste_type, removal_date)
);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
CREATE INDEX idx_removal_date ON waste_removal_act(removal_date);
CREATE INDEX idx_point_date ON waste_removal_act(point_id, removal_date);
CREATE INDEX idx_waste_type ON waste_removal_act(waste_type);
```
## –ê–Ω–∞–ª–∏–∑ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ä–º

### 1. –ü–µ—Ä–≤–∞—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ (1NF)
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**  
- –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∞—Ç–æ–º–∞—Ä–Ω—ã  
- –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –≥—Ä—É–ø–ø—ã  
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á  

**–ê–Ω–∞–ª–∏–∑:**  
- **collection_point:** –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∞—Ç–æ–º–∞—Ä–Ω—ã, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á `point_id`, –Ω–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –≥—Ä—É–ø–ø. ‚úÖ  
- **waste_operator:** –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∞—Ç–æ–º–∞—Ä–Ω—ã, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á `operator_id`, –Ω–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –≥—Ä—É–ø–ø. ‚úÖ  
- **waste_removal_act:** –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∞—Ç–æ–º–∞—Ä–Ω—ã, –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á `act_id`, –Ω–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è –≥—Ä—É–ø–ø. ‚úÖ  

**–í—ã–≤–æ–¥:** –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç 1NF.

---

### 2. –í—Ç–æ—Ä–∞—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ (2NF)
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**  
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 1NF  
- –í—Å–µ –Ω–µ–∫–ª—é—á–µ–≤—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤—Å–µ–≥–æ –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ –∫–ª—é—á–∞  

**–ê–Ω–∞–ª–∏–∑:**  
- **collection_point:** –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç `point_id`. ‚úÖ  
- **waste_operator:** –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç `operator_id`. ‚úÖ  
- **waste_removal_act:** –í—Å–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç `act_id`. ‚úÖ  

**–í—ã–≤–æ–¥:** –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç 2NF.

---

### 3. –¢—Ä–µ—Ç—å—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ (3NF)
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**  
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ 2NF  
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  

**–ê–Ω–∞–ª–∏–∑:**  
- **collection_point:** –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. ‚úÖ  
- **waste_operator:** –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. ‚úÖ  
- **waste_removal_act:** –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –Ω–æ –ø–æ–ª–µ `waste_type` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è. –ò–¥–µ–∞–ª—å–Ω–æ ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É —Ç–∏–ø–æ–≤ –æ—Ç—Ö–æ–¥–æ–≤, –Ω–æ –¥–ª—è –º–∏–Ω–∏–º–∞–ª–∏–∑–º–∞ –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–∞–∫. ‚ö†Ô∏è  

**–í—ã–≤–æ–¥:** –¢–∞–±–ª–∏—Ü—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç 3NF —Å –¥–æ–ø—É—Å—Ç–∏–º—ã–º –∫–æ–º–ø—Ä–æ–º–∏—Å—Å–æ–º –¥–ª—è `waste_type`.

---

### 4. –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ –ë–æ–π—Å–∞-–ö–æ–¥–¥–∞ (BCNF)
**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**  
- –ö–∞–∂–¥–∞—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∞–Ω—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º  

**–ê–Ω–∞–ª–∏–∑:**  
- **collection_point:** –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ `point_id`, `address`. ‚úÖ  
- **waste_operator:** –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏ `operator_id`, `company_name`. ‚úÖ  
- **waste_removal_act:** –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –∫–ª—é—á `act_id`. ‚úÖ  

**–í—ã–≤–æ–¥:** –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç BCNF.

---

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 1
## ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ 
![–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∫ –ø—Ä–æ–µ–∫—Ç—É](https://github.com/PremiumVSTR/-/blob/main/othodi.png)

---

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2
## DDL-–∑–∞–ø—Ä–æ—Å—ã
–¢–∞–±–ª–∏—Ü–∞ collection_point
<img width="896" height="540" alt="image" src="https://github.com/user-attachments/assets/8db6790a-a62b-4e40-9b4e-3a04e3c1f07d" />

–¢–∞–±–ª–∏—Ü–∞ waste_operator
<img width="890" height="548" alt="image" src="https://github.com/user-attachments/assets/41c9a8cc-29f1-4f05-bfb3-8aa84b3f0542" />

–¢–∞–±–ª–∏—Ü–∞ waste_removal_act
<img width="899" height="543" alt="image" src="https://github.com/user-attachments/assets/f71642e4-a868-46d4-b574-38959e004476" />

## –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
<img width="687" height="737" alt="image" src="https://github.com/user-attachments/assets/b69aaee9-83be-4919-aa08-be0db60c983a" />
<img width="701" height="352" alt="image" src="https://github.com/user-attachments/assets/3996c84d-6604-4b19-824d-ff7c0f2c8cea" />
<img width="862" height="758" alt="image" src="https://github.com/user-attachments/assets/c1fbdb7d-bfab-40cf-a362-db7ce669661e" />
<img width="859" height="743" alt="image" src="https://github.com/user-attachments/assets/0ba6b0a9-0408-457e-90c4-77831c354f3b" />

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –≤–≤–µ–¥–µ–Ω—ã

<img width="575" height="692" alt="image" src="https://github.com/user-attachments/assets/5b1759d3-8ff6-46e2-bb6f-7b97731033f3" />
<img width="513" height="428" alt="image" src="https://github.com/user-attachments/assets/26572917-cab9-46b3-a015-64ee80650850" />
<img width="1115" height="740" alt="image" src="https://github.com/user-attachments/assets/5b26ba9d-4efa-466d-b364-80e0bd23b073" />

# SELECT-–∑–∞–ø—Ä–æ—Å—ã —Å JOIN
## –ó–∞–ø—Ä–æ—Å 1: –û—Ç—á–µ—Ç –ø–æ –æ–±—â–µ–º—É –≤–µ—Å—É –≤—ã–≤–µ–∑–µ–Ω–Ω—ã—Ö –æ—Ç—Ö–æ–¥–æ–≤ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –∑–∞ –º–µ—Å—è—Ü –ø–æ —Ä–∞–π–æ–Ω–∞–º (–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ —É–±—ã–≤–∞–Ω–∏—é –≤–µ—Å–∞)
<img width="1260" height="752" alt="image" src="https://github.com/user-attachments/assets/c78c6f88-1560-4a1a-ac66-5e117ed868ef" />

## –ó–∞–ø—Ä–æ—Å 2: –ì—Ä–∞—Ñ–∏–∫ –∏ —á–∞—Å—Ç–æ—Ç–∞ –≤—ã–≤–æ–∑–∞ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω–æ–π –ø–ª–æ—â–∞–¥–∫–∏
<img width="989" height="756" alt="image" src="https://github.com/user-attachments/assets/39d731c9-151e-413b-aa28-a48d61020ec9" />

# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 3
## –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
## –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–ï 1: –û—Ç—á–µ—Ç –ø–æ –≤–µ—Å—É –æ—Ç—Ö–æ–¥–æ–≤ –∑–∞ –º–µ—Å—è—Ü
<img width="627" height="320" alt="image" src="https://github.com/user-attachments/assets/21ecb943-cc2c-42c4-bd5a-ae72f07f0fb7" />

## –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–ï 2: –ì—Ä–∞—Ñ–∏–∫ –≤—ã–≤–æ–∑–∞ –¥–ª—è –ø–ª–æ—â–∞–¥–æ–∫ 
<img width="645" height="429" alt="image" src="https://github.com/user-attachments/assets/a2a1c379-ed70-46dc-a9d3-94d11ad575c2" />

## –ü–†–û–¶–ï–î–£–†–ê 1: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–∫—Ç –≤—ã–≤–æ–∑–∞
<img width="706" height="715" alt="image" src="https://github.com/user-attachments/assets/929161f2-f2ab-4796-9065-46b8d307e4a8" />
```
CREATE OR REPLACE VIEW "Martynovich2261".vw_point_schedule AS
SELECT 
    cp.point_id AS "ID –ø–ª–æ—â–∞–¥–∫–∏",
    cp.address AS "–ê–¥—Ä–µ—Å",
    cp.district AS "–†–∞–π–æ–Ω",
    wra.removal_date AS "–î–∞—Ç–∞ –≤—ã–≤–æ–∑–∞",
    wra.waste_type AS "–¢–∏–ø –æ—Ç—Ö–æ–¥–æ–≤",
    wra.weight_kg AS "–í–µ—Å (–∫–≥)",
    wo.company_name AS "–û–ø–µ—Ä–∞—Ç–æ—Ä"
FROM "Martynovich2261".waste_removal_act wra
JOIN "Martynovich2261".collection_point cp ON wra.point_id = cp.point_id
JOIN "Martynovich2261".waste_operator wo ON wra.operator_id = wo.operator_id
ORDER BY cp.point_id, wra.removal_date DESC;

-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
COMMENT ON VIEW "Martynovich2261".vw_point_schedule 
IS '–ì—Ä–∞—Ñ–∏–∫ –≤—ã–≤–æ–∑–∞ –æ—Ç—Ö–æ–¥–æ–≤ –ø–æ –≤—Å–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–º –ø–ª–æ—â–∞–¥–∫–∞–º';

-- ============================================
-- –ü–†–û–¶–ï–î–£–†–ê 1: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∞–∫—Ç –≤—ã–≤–æ–∑–∞ (–ò–ó–ú–ï–ù–Ø–ï–¢ –ë–î)
-- ============================================
CREATE OR REPLACE PROCEDURE "Martynovich2261".sp_add_removal(
    p_point_id INTEGER,
    p_operator_id INTEGER,
    p_removal_date DATE,
    p_waste_type VARCHAR(50),
    p_weight_kg DECIMAL(10,2),
    OUT p_result_message VARCHAR(200)
)
LANGUAGE plpgsql
AS $$
DECLARE
    v_point_exists BOOLEAN;
    v_operator_exists BOOLEAN;
    v_new_act_id INTEGER;
BEGIN
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–ª–æ—â–∞–¥–∫–∏
    SELECT EXISTS(
        SELECT 1 FROM "Martynovich2261".collection_point 
        WHERE point_id = p_point_id
    ) INTO v_point_exists;
    
    IF NOT v_point_exists THEN
        p_result_message := '–û–®–ò–ë–ö–ê: –ü–ª–æ—â–∞–¥–∫–∞ —Å ID=' || p_point_id || ' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞';
        RETURN;
    END IF;
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
    SELECT EXISTS(
        SELECT 1 FROM "Martynovich2261".waste_operator 
        WHERE operator_id = p_operator_id
    ) INTO v_operator_exists;
    
    IF NOT v_operator_exists THEN
        p_result_message := '–û–®–ò–ë–ö–ê: –û–ø–µ—Ä–∞—Ç–æ—Ä —Å ID=' || p_operator_id || ' –Ω–µ –Ω–∞–π–¥–µ–Ω';
        RETURN;
    END IF;
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Å
    IF p_weight_kg <= 0 THEN
        p_result_message := '–û–®–ò–ë–ö–ê: –í–µ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ 0';
        RETURN;
    END IF;
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞—Ç—É (–Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –±—É–¥—É—â–µ–º)
    IF p_removal_date > CURRENT_DATE THEN
        p_result_message := '–û–®–ò–ë–ö–ê: –î–∞—Ç–∞ –≤—ã–≤–æ–∑–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –±—É–¥—É—â–µ–º';
        RETURN;
    END IF;
    
    -- –ü—Ä–æ–±—É–µ–º –≤—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å—å
    BEGIN
        INSERT INTO "Martynovich2261".waste_removal_act 
            (point_id, operator_id, removal_date, waste_type, weight_kg)
        VALUES 
            (p_point_id, p_operator_id, p_removal_date, p_waste_type, p_weight_kg)
        RETURNING act_id INTO v_new_act_id;
        
        p_result_message := '–£–°–ü–ï–•: –ê–∫—Ç –≤—ã–≤–æ–∑–∞ ‚Ññ' || v_new_act_id || ' –¥–æ–±–∞–≤–ª–µ–Ω';
        
    EXCEPTION 
        WHEN unique_violation THEN
            p_result_message := '–û–®–ò–ë–ö–ê: –í—ã–≤–æ–∑ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ –æ—Ç—Ö–æ–¥–æ–≤ —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ —ç—Ç—É –¥–∞—Ç—É –¥–ª—è —ç—Ç–æ–π –ø–ª–æ—â–∞–¥–∫–∏';
        WHEN OTHERS THEN
            p_result_message := '–û–®–ò–ë–ö–ê: ' || SQLERRM;
    END;
END;
$$;

-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
COMMENT ON PROCEDURE "Martynovich2261".sp_add_removal 
IS '–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π –∞–∫—Ç –≤—ã–≤–æ–∑–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–∞–Ω–Ω—ã—Ö';
```
## –ü–†–û–¶–ï–î–£–†–ê 2: –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Å –∞–∫—Ç–∞ –≤—ã–≤–æ–∑–∞
<img width="674" height="337" alt="image" src="https://github.com/user-attachments/assets/ded1b267-0578-41e1-8d46-f0822f9173fe" />

```
CREATE OR REPLACE PROCEDURE "Martynovich2261".sp_update_removal_weight(
    p_act_id INTEGER,
    p_new_weight_kg DECIMAL(10,2),
    OUT p_result_message VARCHAR(200)
)
LANGUAGE plpgsql
AS $$
DECLARE
    v_old_weight DECIMAL(10,2);
    v_rows_updated INTEGER;
BEGIN
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∞
    IF NOT EXISTS(
        SELECT 1 FROM "Martynovich2261".waste_removal_act 
        WHERE act_id = p_act_id
    ) THEN
        p_result_message := '–û–®–ò–ë–ö–ê: –ê–∫—Ç –≤—ã–≤–æ–∑–∞ —Å ID=' || p_act_id || ' –Ω–µ –Ω–∞–π–¥–µ–Ω';
        RETURN;
    END IF;
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–π –≤–µ—Å
    IF p_new_weight_kg <= 0 THEN
        p_result_message := '–û–®–ò–ë–ö–ê: –ù–æ–≤—ã–π –≤–µ—Å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–µ 0';
        RETURN;
    END IF;
    
    -- –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ä—ã–π –≤–µ—Å –¥–ª—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
    SELECT weight_kg INTO v_old_weight 
    FROM "Martynovich2261".waste_removal_act 
    WHERE act_id = p_act_id;
    
    -- –û–±–Ω–æ–≤–ª—è–µ–º –≤–µ—Å
    UPDATE "Martynovich2261".waste_removal_act 
    SET weight_kg = p_new_weight_kg
    WHERE act_id = p_act_id;
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –æ–±–Ω–æ–≤–∏–ª–∞—Å—å –ª–∏ –∑–∞–ø–∏—Å—å
    GET DIAGNOSTICS v_rows_updated = ROW_COUNT;
    
    IF v_rows_updated = 0 THEN
        p_result_message := '–û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç –≤—ã–≤–æ–∑–∞';
    ELSE
        p_result_message := '–£–°–ü–ï–•: –í–µ—Å –∞–∫—Ç–∞ ‚Ññ' || p_act_id || ' –∏–∑–º–µ–Ω–µ–Ω —Å ' || 
                           v_old_weight || ' –∫–≥ –Ω–∞ ' || p_new_weight_kg || ' –∫–≥';
    END IF;
END;
$$;

-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
COMMENT ON PROCEDURE "Martynovich2261".sp_update_removal_weight 
IS '–û–±–Ω–æ–≤–ª—è–µ—Ç –≤–µ—Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∞–∫—Ç–∞ –≤—ã–≤–æ–∑–∞';
```
# –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´:
## 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π:
<img width="861" height="622" alt="image" src="https://github.com/user-attachments/assets/db9c5046-1416-4315-9080-28838b8a86c1" />
<img width="1014" height="584" alt="image" src="https://github.com/user-attachments/assets/0b183855-32f2-4c6d-b4d1-340e7dfcb110" />
## 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä:
<img width="625" height="495" alt="image" src="https://github.com/user-attachments/assets/64543218-997b-4b92-9e11-68ed4c8ce7d8" />
<img width="719" height="451" alt="image" src="https://github.com/user-attachments/assets/39d106eb-14d5-4659-97fb-6958583dc714" />
<img width="486" height="552" alt="image" src="https://github.com/user-attachments/assets/170ce07b-9473-457e-b926-6159343575af" />
<img width="594" height="378" alt="image" src="https://github.com/user-attachments/assets/631c3265-0173-4c73-ba0f-121c24d96ea8" />

